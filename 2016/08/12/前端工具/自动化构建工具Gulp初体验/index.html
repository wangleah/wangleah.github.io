<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>自动化构建工具Gulp初体验 | wangleah</title><link rel="stylesheet" type="text/css" href="//fonts.css.network/css?family=Source+Code+Pro"><link rel="stylesheet" type="text/css" href="/css/style.css?v=1.3.0"><link rel="stylesheet" type="text/css" href="/css/highlight.css?v=1.3.0"><link rel="Shortcut Icon" href="/favicon.ico"><link rel="bookmark" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">自动化构建工具Gulp初体验</h1><a id="logo" href="/.">wangleah</a><p class="description">不要因为别人的光芒，而忘了自己想走的路!</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 文档列表</i></a><a href="https://github.com/wangleah"><i class="fa fa-user"> github</i></a></div></div><div id="layout" class="layout-g"><div class="layout-l"><div class="content_container"><div class="post"><h1 class="post-title">自动化构建工具Gulp初体验</h1><div class="post-meta">Aug 12, 2016</div><div class="post-content"><p><strong>自动化构建工具</strong></p>
<p>对于前端开发来说，自动化构建工具非常重要。他能够帮助我们自动完成许多任务，能够极大的提高我们的工作效率。当然，流行的工具比较多，比如grunt，gulp，webpack等，了解不多的同学可能就开始迷茫了，到底应该学习哪一种？其实实际情况上，除了grunt与gulp是存在替换关系，gulp与其他大多数工具都是可以通过插件相互渗透的，比如webpack，在gulp中有gulp-webpack插件能够完成webpack的工作，比如gulp-bower插件能够完成bower的功能。而gulp比grunt效率更高，更简便的IO操作，更少的API，因此我们只需要好好掌握gulp，就足够了，不需要给自己徒增烦恼。</p>
<a id="more"></a>
<p><strong>学前准备</strong></p>
<p>安装nodejs与npm</p>
<p>在nodejs官网找到对应的版本安装即可，新的nodejs已经集成了npm，在命令行中输入一下指令检测nodejs与npm是否已经安装成功，如果你是在window下使用命令行，建议使用git的命令行工具</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">// 输出node版本</div><div class="line">&gt; node -v</div><div class="line"></div><div class="line">// 输出npm版本</div><div class="line">&gt; npm -v</div></pre></td></tr></table></figure>
<p>npm是node的包管理工具，用于管理node的相关插件，使用的几个常用的相关指令如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">// 安装插件</div><div class="line">&gt; [sudo] npm install &lt;name&gt; [-g] [--save-dev]</div><div class="line"></div><div class="line">// 卸载插件</div><div class="line">&gt; [sudo] npm uninstall &lt;name&gt; [-g] [--save-dev]</div><div class="line"></div><div class="line">// 更新插件</div><div class="line">&gt; [sudo] npm update &lt;name&gt; [-g] [--save-dev]</div></pre></td></tr></table></figure>
<p>上面的语法中，中括号[]表示可选参数，尖括号&lt;&gt;表示必填参数，他们分别表示的含义如下</p>
<p>[sudo]: 在类unix操作系统下表示允许使用过通过安全的方式使用特殊权限执行后面的指令，比如在mac os x环境下会因为权限问题指令被拒绝就需要使用到它。</p>
<p><name>: 插件名字，如果是安装gulp-sass，那么指令如下</name></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&gt; npm install gulp-sass</div></pre></td></tr></table></figure>
<p>安装gulp</p>
<p>在安装之前，请确保已经安装了nodejs与npm</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">// 安装gulp</div><div class="line">&gt; npm install -g gulp</div><div class="line"></div><div class="line">// 通过输出版本号检测是否已经安装成功</div><div class="line">&gt; gulp -v</div></pre></td></tr></table></figure>
<p>于是到这里，一切就准备就绪了，是时候来感受一下gulp的魅力了。</p>
<p>为了大家更好的学习gulp，我在我的github上新建了一个项目 learn-gulp，我会把每一步每一个知识点都作为一次提交push到项目中，这样大家就可以通过查看历史版本，循序渐进的学习gulp的配置了。欢迎大家的fork与star。点击文末的阅读原文或者通过下面的项目地址访问</p>
<p><a href="undefined">https://github.com/yangbo5207/learn-gulp</a></p>
<p>我们先通过一个非常简单的例子，了解一下gulp如何将sass文件编译成css的。在动手尝试之前，我们有2个文件需要重点了解一下</p>
<p><strong>package.json</strong></p>
<p>package.json作为gulp的配置文件，能够非常方便的管理nodejs的插件，因为一个项目所要依赖的插件很多，因此不可能将所有的插件都放在git中来管理，我们只需要在项目中保存有一个package.json的配置文件，那么就可以通过下面的指令将该配置文件中的所有依赖包下载下来。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&gt; npm install</div></pre></td></tr></table></figure>
<p>在后续的gulp进阶文章中，我会详细的给大家罗列package.json中所有字段的详细功能。另外，由于这个配置文件中仅仅只是一个json，因此我们可以保存我们自己需要的字段，并且通过node读取使用。</p>
<p><strong>gulpfile.js</strong></p>
<p>gulpfile.js是gulp项目中的配置文件，通过这个普通的js文件，我们可以定义gulp的行为，所有的gulp任务都将在这个js文件中来配置。如何编写这个js文件将是我们学会使用gulp的关键。</p>
<p>那么，所有的准备工作与基本的概念我们都有一个了解之后呢，我们就可以通过一个简单的例子来感受一下gulp带给我们的便利了。</p>
<p><strong>实例</strong></p>
<p>通过插件gulp-sass，我们可以将sass文件编译为css文件，sass是css的预编译语言，属于能够10分钟掌握的简单语言，但是它却足够强大，它突破css的局限性，让css也能够玩出花来，值得大家去学习掌握。在实际开发中，为了提高开发效率，我们往往都不会直接使用css，而是通过编写sass或者less，然后编译为css。</p>
<p>任意新建一个文件夹，该文件夹将被当做是我们目前的项目目录。在该目录中安装gulp-sass插件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&gt; npm install gulp-sass</div></pre></td></tr></table></figure>
<p>安装完成之后，我们可以看到目录中生成了一个叫做node-modules的文件夹，gulp-sass插件就被安装在node-modules中。</p>
<p>在该目录下新建一个叫做gulpfile.js的文件，并输入以下代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">// gulpfile.js</div><div class="line">&apos;use strict&apos;;</div><div class="line"></div><div class="line">var gulp = require(&apos;gulp&apos;);</div><div class="line">var sass = require(&apos;gulp-sass&apos;);</div><div class="line"></div><div class="line">gulp.task(&apos;css&apos;, function() &#123;</div><div class="line">   return gulp.src(&apos;./style/*.scss&apos;)</div><div class="line">       .pipe(sass())</div><div class="line">       .pipe(gulp.dest(&apos;./style/&apos;))</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>在上面的代码中，我创建了一个叫做css的任务，该任务识别style文件夹中的sass文件，通过sass()将sass文件转换成css文件并保存在style中。</p>
<p>因此我们在项目根目录下创建style文件夹，文件夹里新建一个叫做test.scss的文件，随便写一点sass语法，就可以查看gulp能否编译成功</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">body &#123;    </div><div class="line">    margin: 0;    </div><div class="line">    div &#123;        </div><div class="line">        border: 1px solid red;    </div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>运行如下指令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&gt; gulp css</div></pre></td></tr></table></figure>
<p>在我的环境下，</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">➜  learn-gulp git:(master) ✗ gulp css</div><div class="line">[16:47:51] Using gulpfile ~/develop/me/learn-gulp/gulpfile.js</div><div class="line">[16:47:51] Starting &apos;css&apos;...</div><div class="line">[16:47:51] Finished &apos;css&apos; after 36 ms</div></pre></td></tr></table></figure>
<p>成功运行之后，在style文件夹下面发现了一个新的css文件，test.css，这就是sass文件编译而来。</p>
<p>从上面的例子我们可以看出，gulp构建工具的关键就在gulpfile.js中，为了进一步感受gulp的魅力，我们下面引入更多的插件来管理css文件<br>所有的插件在gulpfile.js中使用之前，都必须安装，安装通过npm install指令即可，插件名就是下面js中require后面的名字。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line">&apos;use strict&apos;;</div><div class="line">var gulp = require(&apos;gulp&apos;);</div><div class="line"></div><div class="line">// css 相关插件</div><div class="line">var sass         = require(&apos;gulp-sass&apos;);         // 编译sass</div><div class="line">var autoprefixer = require(&apos;gulp-autoprefixer&apos;); // 补全前缀</div><div class="line">var csscomb      = require(&apos;gulp-csscomb&apos;);      // 格式化css样式，排序</div><div class="line">var cssbeautify  = require(&apos;gulp-cssbeautify&apos;);  // 美化css样式</div><div class="line">var minifycss    = require(&apos;gulp-minify-css&apos;);   // 压缩css文件</div><div class="line"></div><div class="line">// 错误捕获var plumber = require(&apos;gulp-plumber&apos;);</div><div class="line"></div><div class="line">gulp.task(&apos;css&apos;, function() &#123;</div><div class="line">    gulp.src(&apos;./style/*.scss&apos;)</div><div class="line">        .pipe(plumber())</div><div class="line">        .pipe(sass())</div><div class="line">        .pipe(autoprefixer(&#123;</div><div class="line">            browsers: [&apos;last 2 versions&apos;, &apos;Android &gt;= 4.0&apos;],</div><div class="line">            cascade: true, //是否美化属性值 默认：true 像这样：</div><div class="line">                                        //-webkit-transform: rotate(45deg);</div><div class="line">                                        //                transform: rotate(45deg);</div><div class="line">           remove:true //是否去掉不必要的前缀 默认：true</div><div class="line">       &#125;))</div><div class="line">       .pipe(csscomb())</div><div class="line">       .pipe(minifycss(&#123;</div><div class="line">           aggressiveMerging: false,</div><div class="line">           advanced: false,            //类型：Boolean 默认：true [是否开启高级优化（合并选择器等）]</div><div class="line">           compatibility: &apos;ie7&apos;,       //保留ie7及以下兼容写法 类型：String 默认：&apos;&apos;or&apos;*&apos; [启用兼容模式； &apos;ie7&apos;：IE7兼容模式，&apos;ie8&apos;：IE8兼容模式，&apos;*&apos;：IE9+兼容模式]</div><div class="line">           keepBreaks: true,           //类型：Boolean 默认：false [是否保留换行]</div><div class="line">           keepSpecialComments: &apos;*&apos;    //保留所有特殊前缀 当你用autoprefixer生成的浏览器前缀，如果不加这个参数，有可能将会删除你的部分前缀</div><div class="line">       &#125;))</div><div class="line">       .pipe(gulp.dest(&apos;./style/&apos;));</div><div class="line">   &#125;);</div></pre></td></tr></table></figure>
<p>这样的一个css任务，几乎就可以用于实际开发了。</p>
<p>但我们想要的最终效果是，只要我们保存了sass文件，那么gulp中我们定义的css任务就会自动执行，并且，浏览器中的页面，也会自动刷新。</p>
<p>而现在我们只能输入gulp css指令才能够完成编译，因此我们还需要做许多其他的配置。</p>
<p>gulp.watch 与 gulp-livereload插件</p>
<p>为了能够实现我们想要的效果，我们得借助插件gulp-livereload。通过这个插件，我们能够完成实现浏览器的自动刷新。想要实现这个效果，我们还得在chrome浏览器中安装livereload插件。如果能翻墙就很好办，如果不能翻墙那就自己想办法吧 - -！然后我们还要在gulpfile.js中的css任务中添加如下代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">...</div><div class="line">.pipe(gulp.dest(&apos;./style/&apos;))</div><div class="line">.pipe(livereload(&#123; quiet: true &#125;));</div></pre></td></tr></table></figure>
<p>为了能够检测到scss文件的变化，我们还得创建一个watch任务，用于监听文件变化</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">gulp.task(&apos;watch&apos;, function() &#123;</div><div class="line">    livereload.listen();</div><div class="line">    </div><div class="line">       gulp.watch(&apos;./style/*.scss&apos;, [&apos;css&apos;]);</div><div class="line">&#125;)</div><div class="line">       </div><div class="line">// 默认执行watch任务</div><div class="line">gulp.task(&apos;default&apos;, [&apos;watch&apos;]);</div></pre></td></tr></table></figure>
<p>这样，就可以实现我们想要的效果了。在命令行中输入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&gt; gulp</div></pre></td></tr></table></figure>
<p>出现下面的提示</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">➜  learn-gulp git:(master) ✗ gulp</div><div class="line">[16:39:02] Using gulpfile ~/develop/me/learn-gulp/gulpfile.js</div><div class="line">[16:39:02] Starting &apos;watch&apos;...</div><div class="line">[16:39:02] Finished &apos;watch&apos; after 13 ms</div><div class="line">[16:39:02] Starting &apos;default&apos;...</div><div class="line">[16:39:02] Finished &apos;default&apos; after 7.08 μs</div></pre></td></tr></table></figure>
<p>就表示gulp任务已经启动监听，然后在浏览器中点击一下livereload插件的图标，让中间的空心圆变成实心圆，改变scss文件并保存就能够自动刷新页面了。</p>
<p>文章的中间可能会有一些文件的创建没有说到，因此最好建议大家去github上的learn-gulp项目，所有的细节都在里面。配合本文的讲解，相信学会gulp不是难事。<br><a href="undefined">https://github.com/yangbo5207/learn-gulp</a><br>这篇文章算是对gulp的一个简单入门，接下来的一篇文章我会为大家分析一下gulp的一些api，让大家能够轻松自如的编写gulpfile.js。</p>
</div><div class="tags"></div><div class="post-nav"><a href="/2016/08/12/javascript/获取当前元素的所有兄弟元素/" class="pre">获取当前元素的所有兄弟元素</a><a href="/2016/08/05/javascript/获取任意一个元素中的第一个子元素/" class="next">获取任意一个元素中的第一个子元素</a></div><div id="comments"></div></div></div></div><div class="layout-r hidden_mid_and_down"><div id="sidebar"><div class="widget"><div id="search-form"><div id="result-mask" class="hide"></div><label><input id="search-key" type="text" autocomplete="off" placeholder="请输入关键字..."/></label><div id="result-wrap" class="hide"><div id="search-result"></div></div><div class="hide"><template id="search-tpl"><div class="item"><a href="/{path}" title="{title}"><div class="title">{title}</div><div class="time">{date}</div><div class="tags">{tags}</div></a></div></template></div></div></div><div class="widget"><div class="widget-title"><i class="fa fa-fei"> 归档</i></div><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">三月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">九月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">八月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">五月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">四月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/06/">六月 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/04/">四月 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/03/">三月 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/02/">二月 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/01/">一月 2015</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-xie"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/03/10/前端工具/mongodb安装及相关配置/">mongodb安装、配置及操作命令</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/15/javascript/原生JS在IE中的兼容性/">原生JS在IE中的兼容性</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/12/javascript/获取当前元素的所有兄弟元素/">获取当前元素的所有兄弟元素</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/12/前端工具/自动化构建工具Gulp初体验/">自动化构建工具Gulp初体验</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/05/javascript/获取任意一个元素中的第一个子元素/">获取任意一个元素中的第一个子元素</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/12/前端工具/gulp指南/">gulp指南</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/15/javascript/三大系列——element元素结点属性/">三大系列——element元素结点属性</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/10/javascript/返回指定时间格式/">返回指定的日期格式</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/06/18/css/Flex布局新旧混合写法详解（兼容微信）/">Flex布局新旧混合写法</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/04/10/javascript/深入浅出妙用 Javascript 中 apply、call、bind/">Javascript 中 apply、call、bind</a></li></ul></div></div></div></div><a id="totop" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=1.3.0" async></script><div id="footer"><div class="footer-info"><p><span> Copyright &copy;<a href="/." rel="nofollow">wangleah</a></span></p></div></div></div><script type="text/javascript" src="/js/search.json.js?v=1.3.0"></script></body></html>